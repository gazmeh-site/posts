## چرا تست API اهمیت دارد؟
در حال حاضر بسیاری از شرکت‌ها به سمت توسعه و پیاده‌سازی سیستم‌های مبتنی بر معماری microservice پیش می‌روند. microserviceها برای تولیدکنندگان نرم‌افزار جذاب هستند زیرا اجازه می‌دهند اجزای نرم‌افزار با سرعت بیشتری توسعه داده شوند. زمانی که یک بخش از برنامه در حال  بروزرسانی می‌باشد، بخش‌های دیگر برنامه می‌توانند به کار خود ادامه دهند. در این دوره، کاربران انتظار دارند نرم افزار هر زمان که بخواهند برای استفاده در دسترس باشد. بنابراین با توجه به این موضوع که سیستم‌های نرم‌افزاری باید همیشه در دسترس باشند، تست نرم‌افزار از اهمیت بالایی برخوردار می‌شود.
اکثر microserviceها از API استفاده میکنند، بنابراین تست API یک فرایند بسیار مهم برای اکثر برنامه‌های تحت وب و تلفن همراه است. حتی زمانی که رابط کاربری در دسترس است ، تست API اغلب سریع‌تر اجرا می‌شود و انعطاف پذیری بیشتری در محیط‌های microservice ایجاد می کند.


## API چیست؟
هر API یا (Application Programming Interface) راهی برای تعامل برنامه‌ها با یکدیگر می‌باشد. در واقع یک API رابطی است که برنامه‌ها می‌توانند با یکدیگر ارتباط برقرار کنند.
API های زیادی توسط برخی شرکت‌ها در دسترس می‌باشند که به شما این امکان را می‌دهند تا با خدمات آن‌ها ارتباط برقرار کنید. رایج‌ترین نوع ‌API که هنگام تست برنامه‌ها مشاهده می‌کنید REST API است. برای تست REST API، نیاز است که endpoint ای که می خواهیم از آن استفاده کنیم را مشخص کنیم. به عبارت دیگر هر endpoint یک URL می‌باشد که دسترسی به سرویس‌های یک سیستم را امکان‌پذیر می‌کند.
همچنین نیاز است که فعل (Method) درخواست را نیز مشخص نماییم. هر درخواست میتواند یکی از متدهای `GET،PUT،POST،DELETE و …` را داشته باشد. این متدها مشخص میکنند که آیا ما میخواهیم اطلاعاتی را از سرور دریافت کنیم (GET)،  تغییراتی را در آن ایجاد کنیم (PUT/PATCH) و … .

![API Model](./resources/api-model.png?raw=true "API Model")
 

تست API یکی از موارد مهم در تولید نرم‌افزار می‌باشد که باید مورد توجه قرار گیرد. برای تست API ابزار مختلفی وجود دارد که Postman یکی از ابزارهای محبوب و رایج می‌باشد.

  
## Postman چیست؟
  Postman یک ابزار قدرتمند تست API است که امکان تست API ها را بصورت خودکار فراهم می کند. در ابتدا Postman یک افزونه Chrome بود، اما قدرتمندتر شده و به یک برنامه دسکتاپ کامل تبدیل شده است. برای شروع تست API با استفاده از این ابزار، ابتدا باید آن را نصب کنید.
    
### مزایای استفاده از Postman:
  > * **استفاده رایگان**
  > * **نصب و پیکربندی آسان**
  > * **رابط کاربری گرافیکی:** رابط کاربری آسانی دارد و یادگیری آن نیاز به زمان زیادی ندارد.
  > * **دسترسی آسان:** میتوان هر زمان که لازم بود تنها با وارد شدن به حساب کاربری به فایل های خود دسترسی داشت.
    
## نصب و راه اندازی
### 1. دانلود و نصب Postman
برای دانلود این ابزار به سایت [Postman](https://www.postman.com/downloads/) مراجعه کرده و با  توجه به سیستم عامل خود نسخه مربوطه را دانلود کنید. پس از دانلود، آن را می توان به راحتی مانند برنامه‌های دیگر نصب کرد
    
### 2. راه اندازی Postman
برای راه‌اندازی Postman کافی است برنامه Postman را که به تازگی نصب کرده‌اید اجرا کنید. اولین باری که آن را باز می‌کنید، می‌توانید یک حساب کاربری رایگان ایجاد کنید (این مرحله اجباری نیست.) حساب رایگان برای استفاده برخی از قابلیت‌های آنلاین Postman مانند به اشتراک‌گذاری تست‌هایی که به صورت محلی اجرا می کنید مفید است.
Postman برای تست، building blockهای مختلفی را فراهم نموده است که می‌توان برای ایجاد انواع مختلف تست API استفاده نمود. با کلیک بر روی باتن New در سمت چپ بالای صفحه می‌توانید building blockهای در دسترس را مشاهده نمایید.
  
![Building Blocks](./resources/building-blocks.png?raw=true "Building Blocks")

در این پست اجرای یک API ساده مانند درخواست دریافت آگهی‌های مربوط به خودرو سواری در سایت دیوار را بررسی میکنیم.
    
### 3. ایجاد یک درخواست (Request)
پیش از ایجاد یک Request نیاز است که یک collection ساخته شود. هر collection مانند پوشه ای است که درخواست‌های مختلف را دسته بندی میکند.
به دو طریق می توانید یک Collection جدید ایجاد کنید:
    
- با کلیک بر روی Collection در بخش building block 
- استفاده از باتن پلاس در سمت چپ صفحه
    
![Create New Collection](./resources/new-collection.png?raw=true "Create New Collection")
    
سپس در قسمت Name نام مورد نظر خود را نوشته و آن را ایجاد کنید.
    
![Create New Collection](./resources/create-collection.png?raw=true "Create New Collection")
    
پس از ایجاد یک collection زمان آن رسیده که یک Request بسازید. شما میتوانید از بخش building block و یا با کلیک راست بر روی collection ساخته شده و انتخاب گزینه Add Request درخواست خود را ایجاد کنید. 
پس از وارد کردن اسم مورد نظر، درخواست خود را ذخیره میکنیم.
![Create New Request](./resources/new-request.png?raw=true "Create New Request")
    
### 4. اجرای یک درخواست
در این پست سعی داریم API مربوط به دریافت آگهی‌های خودرو در سایت دیوار را بررسی کنیم.    
با ارسال درخواست به آدرس `https://api.divar.ir/v8/web-search/tehran-province/auto` درخواستی از نوع `GET` در بستر پروتکل `HTTP` به سرور دیوار ارسال میشود. پس از آن، سرور پاسخ را به مرورگر ارسال میکند و مرورگر لیست خودروها را به کاربر نمایش میدهد. لیست درخواست‌های ارسالی توسط مرورگر در قسمت `Developer tools` در تب `Network` در دسترس است. با انتخاب API مورد نظر میتوان جزییات درخواست را در تب Headers و Response مشاهده کرد.
پس از مشاهده جزئیات API زمان آن رسیده که آن را در Postman پیاده سازی کنیم.
![Divar](./resources/divar.png?raw=true "Divar")
    
با کلیک بر روی drop down، لیستی از http methodها را مشاهده میکنید که میتوانید بسته به نیاز خود آن را تغییر دهید. این مقدار در Postman به صورت پیش فرض روی Get میباشد.
    
![API Methods](./resources/request-methods.png?raw=true "API Methods")
    
بنابراین طبق شکل زیر، متد درخواست را Get انتخاب کرده و در بخش URL آدرس ذکر شده را قرار میدهیم. سپس برای ارسال درخواست روی باتن Send کلیک میکنیم.
    
![Create New Request](./resources/create-request.png?raw=true "Create New Request")
    
Postman بعضی از تنظیمات مورد نیاز را به صورت خودکار انجام میدهد. به عنوان مثال، هر Header و یا اطلاعات دیگری را که ممکن است به آن نیاز داشته باشید را اضافه کرده، درخواست را ارسال می کند و پس از مدت کوتاهی پاسخ را میتوانید در قسمت Body در پایین صفحه مشاهده کنید.
  
![Postman Response](./resources/response.png?raw=true "Postman Response")
  
پس از اجرا، پاسخ درخواست را که شامل اطلاعات و لیست آگهی‌های خودرو سواری است در قالب Json دریافت میکنیم.
شما میتوانید هر API دیگری را مانند مثال بالا و با تغییر endpoint و متد درخواست، پیاده سازی کنید. 

تست API در Postman شامل موارد بیشتری از ارسال یک یا دو درخواست است. ما در مقاله های بعدی به صورت کامل تر این موارد را بررسی خواهیم کرد.
